From 9fdbdbc0eb5de43cb336f46e5fd41016ecc5ae10 Mon Sep 17 00:00:00 2001
From: Rafael Palomar <rafael.palomar@rr-research.no>
Date: Tue, 3 Mar 2020 07:02:53 +0100
Subject: [PATCH 26/29] ENH: Change SlicerApp-real -> Slicer

---
 CMake/SlicerMacroBuildApplication.cmake           | 2 +-
 CMakeLists.txt                                    | 6 ++----
 Utilities/Scripts/CMakeLists.txt                  | 3 ++-
 Utilities/Scripts/SlicerWizard/CMakeLists.txt     | 6 +++++-
 Utilities/Scripts/SlicerWizard/ExtensionWizard.py | 2 +-
 Utilities/Templates/CMakeLists.txt                | 7 ++++++-
 6 files changed, 17 insertions(+), 9 deletions(-)

diff --git a/CMake/SlicerMacroBuildApplication.cmake b/CMake/SlicerMacroBuildApplication.cmake
index 03f2a67aea..0b6df73497 100644
--- a/CMake/SlicerMacroBuildApplication.cmake
+++ b/CMake/SlicerMacroBuildApplication.cmake
@@ -413,7 +413,7 @@ macro(slicerMacroBuildApplication)
 
   set(executable_name ${SLICERAPP_APPLICATION_NAME})
   if(NOT APPLE)
-    set(executable_name ${executable_name}App-real)
+    set(executable_name ${executable_name})
   endif()
   message(STATUS "Setting ${SLICERAPP_APPLICATION_NAME} executable name to '${executable_name}${CMAKE_EXECUTABLE_SUFFIX}'")
 
diff --git a/CMakeLists.txt b/CMakeLists.txt
index 7823f069f8..0f7b5314e1 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -937,10 +937,8 @@ add_subdirectory(Libs)
 add_subdirectory(Base)
 add_subdirectory(Resources)
 add_subdirectory(Utilities/Scripts)
-if(Slicer_BUILD_EXTENSIONMANAGER_SUPPORT)
-  add_subdirectory(Utilities/Scripts/SlicerWizard)
-  add_subdirectory(Utilities/Templates)
-endif()
+add_subdirectory(Utilities/Scripts/SlicerWizard)
+add_subdirectory(Utilities/Templates)
 
 #-----------------------------------------------------------------------------
 # Macro useful to build ModuleLogic, ModuleMRML and ModuleWidgets libraries
diff --git a/Utilities/Scripts/CMakeLists.txt b/Utilities/Scripts/CMakeLists.txt
index de127e9541..519586584b 100644
--- a/Utilities/Scripts/CMakeLists.txt
+++ b/Utilities/Scripts/CMakeLists.txt
@@ -1,4 +1,5 @@
-if(Slicer_BUILD_EXTENSIONMANAGER_SUPPORT AND Slicer_USE_PYTHONQT)
+if(Slicer_USE_PYTHONQT)
+
   # Determine name of Python interpreter
   #
   # NOTE: Do NOT use ${PYTHON_EXECUTABLE}; when using our own Python, it is set
diff --git a/Utilities/Scripts/SlicerWizard/CMakeLists.txt b/Utilities/Scripts/SlicerWizard/CMakeLists.txt
index 675a5ee232..8f969299da 100644
--- a/Utilities/Scripts/SlicerWizard/CMakeLists.txt
+++ b/Utilities/Scripts/SlicerWizard/CMakeLists.txt
@@ -29,7 +29,11 @@ set(SlicerWizard_PYTHON_SCRIPTS
   WizardHelpFormatter.py
   )
 
-if(Slicer_BUILD_EXTENSIONMANAGER_SUPPORT AND Slicer_USE_PYTHONQT)
+if(NOT DEFINED PYTHON_SITE_DIR)
+  set(PYTHON_SITE_DIR ${Slicer_INSTALL_BIN_DIR}/Python)
+endif()
+
+if(Slicer_USE_PYTHONQT)
   ctkMacroCompilePythonScript(
     TARGET_NAME SlicerWizard
     SCRIPTS "${SlicerWizard_PYTHON_SCRIPTS}"
diff --git a/Utilities/Scripts/SlicerWizard/ExtensionWizard.py b/Utilities/Scripts/SlicerWizard/ExtensionWizard.py
index 2585425d75..2a0cc79169 100644
--- a/Utilities/Scripts/SlicerWizard/ExtensionWizard.py
+++ b/Utilities/Scripts/SlicerWizard/ExtensionWizard.py
@@ -648,7 +648,7 @@ class ExtensionWizard(object):
 
     candidateBuiltInTemplatePaths = [
         os.path.join(scriptPath, "..", "..", "..", "Utilities", "Templates"), # Run from source directory
-        os.path.join(scriptPath, "..", "..", "..", "share", # Run from install
+        os.path.join(scriptPath, "..", "..", "..", "..", "share", # Run from install
                      "Slicer-%s.%s" % tuple(__version_info__[:2]),
                      "Wizard", "Templates")
         ]
diff --git a/Utilities/Templates/CMakeLists.txt b/Utilities/Templates/CMakeLists.txt
index 3938d41acd..50ecf8035e 100644
--- a/Utilities/Templates/CMakeLists.txt
+++ b/Utilities/Templates/CMakeLists.txt
@@ -8,6 +8,11 @@ configure_file(
  ${CMAKE_CURRENT_SOURCE_DIR}/Extensions/extension_description.s4ext.in
  ${Slicer_BINARY_DIR}/Utilities/Templates/Extensions/extension_description.s4ext.in
  COPYONLY
-)
+ )
+
+install(
+  FILES ${Slicer_BINARY_DIR}/Utilities/Templates/Extensions/extension_description.s4ext.in
+  DESTINATION ${CMAKE_INSTALL_PREFIX}/${Slicer_INSTALL_SHARE_DIR}/Wizard/Templates
+  )
 
 include(SlicerExtensionTemplatesGenerator)
-- 
2.26.2

